2011-07-15 00:15:05,895+0530 DEBUG Loader Max heap: 238616576
2011-07-15 00:15:05,896+0530 DEBUG textfiles BEGIN SWIFTSCRIPT:
type messagefile {} 
type countfile {} 

(countfile t) countwords (messagefile f) {   
    app {
        wc "-w" @filename(f) stdout=@filename(t);
    }
}

string inputNames = "one.txt two.txt three.txt";
string outputNames = "one.count two.count three.count";

messagefile inputfiles[] <array_mapper;files=inputNames>;
countfile outputfiles[] <array_mapper;files=outputNames>;

outputfiles[0] = countwords(inputfiles[0]);
outputfiles[1] = countwords(inputfiles[1]);
outputfiles[2] = countwords(inputfiles[2]);



2011-07-15 00:15:05,896+0530 DEBUG textfiles END SWIFTSCRIPT:
2011-07-15 00:15:05,897+0530 INFO  Loader q22.swift: source file is new. Recompiling.
2011-07-15 00:15:06,916+0530 INFO  Karajan Validation of XML intermediate file was successful
2011-07-15 00:15:07,299+0530 DEBUG textfiles using default sites file
2011-07-15 00:15:07,322+0530 INFO  VDL2ExecutionContext Stack dump:
Level 1
[iA = 0, iB = 0, bA = false, bB = false]
	vdl:instanceconfig = Swift configuration []
	vdl:operation = run
	PATH_SEPARATOR = /
	swift.home = /home/yadu/bin/cog/modules/swift/dist/swift-svn/bin/..
	#vdl:futureWrapperMap = org.griphyn.vdl.karajan.WrapperMap@19eda2c


2011-07-15 00:15:08,126+0530 INFO  unknown Using sites file: /home/yadu/bin/cog/modules/swift/dist/swift-svn/bin/../etc/sites.xml
2011-07-15 00:15:08,173+0530 INFO  unknown Using tc.data: /home/yadu/bin/cog/modules/swift/dist/swift-svn/bin/../etc/tc.data
2011-07-15 00:15:08,333+0530 INFO  AbstractScheduler Setting resources to: {localhost=localhost}
2011-07-15 00:15:09,053+0530 INFO  unknown Swift svn swift-r4697 (swift modified locally) cog-r3167

2011-07-15 00:15:09,054+0530 INFO  unknown RUNID id=run:20110715-0015-xl22a155
2011-07-15 00:15:09,161+0530 INFO  SetFieldValue Set: inputNames=one.txt two.txt three.txt
2011-07-15 00:15:09,161+0530 INFO  SetFieldValue Set: outputNames=one.count two.count three.count
2011-07-15 00:15:09,191+0530 DEBUG VDL2ExecutionContext java.lang.RuntimeException: getArrayValue called on a struct: outputNames:string = one.count two.count three.count - Closed
java.lang.RuntimeException: getArrayValue called on a struct: outputNames:string = one.count two.count three.count - Closed
Caused by: java.lang.RuntimeException: getArrayValue called on a struct: outputNames:string = one.count two.count three.count - Closed
	at org.griphyn.vdl.mapping.AbstractDataNode.getArrayValue(AbstractDataNode.java:330)
	at org.griphyn.vdl.mapping.file.ArrayFileMapper.existing(ArrayFileMapper.java:30)
	at org.griphyn.vdl.mapping.RootDataNode.checkInputs(RootDataNode.java:131)
	at org.griphyn.vdl.mapping.RootArrayDataNode.checkInputs(RootArrayDataNode.java:71)
	at org.griphyn.vdl.mapping.RootArrayDataNode.innerInit(RootArrayDataNode.java:59)
	at org.griphyn.vdl.mapping.RootArrayDataNode.handleClosed(RootArrayDataNode.java:83)
	at org.griphyn.vdl.mapping.AbstractDataNode.notifyListeners(AbstractDataNode.java:604)
	at org.griphyn.vdl.mapping.AbstractDataNode.closeShallow(AbstractDataNode.java:403)
	at org.griphyn.vdl.mapping.AbstractDataNode.setValue(AbstractDataNode.java:350)
	at org.griphyn.vdl.mapping.RootDataNode.setValue(RootDataNode.java:229)
	at org.griphyn.vdl.karajan.lib.SetFieldValue.deepCopy(SetFieldValue.java:116)
	at org.griphyn.vdl.karajan.lib.SetFieldValue.function(SetFieldValue.java:52)
	at org.griphyn.vdl.karajan.lib.VDLFunction.post(VDLFunction.java:67)
	at org.globus.cog.karajan.workflow.nodes.AbstractSequentialWithArguments.completed(AbstractSequentialWithArguments.java:194)
	at org.globus.cog.karajan.workflow.nodes.FlowNode.complete(FlowNode.java:214)
	at org.globus.cog.karajan.workflow.nodes.FlowContainer.post(FlowContainer.java:58)
	at org.globus.cog.karajan.workflow.nodes.functions.Argument.post(Argument.java:48)
	at org.globus.cog.karajan.workflow.nodes.AbstractSequentialWithArguments.completed(AbstractSequentialWithArguments.java:194)
	at org.globus.cog.karajan.workflow.nodes.FlowNode.complete(FlowNode.java:214)
	at org.globus.cog.karajan.workflow.nodes.FlowContainer.post(FlowContainer.java:58)
	at org.globus.cog.karajan.workflow.nodes.functions.AbstractFunction.post(AbstractFunction.java:28)
	at org.globus.cog.karajan.workflow.nodes.Sequential.startNext(Sequential.java:29)
	at org.globus.cog.karajan.workflow.nodes.Sequential.executeChildren(Sequential.java:20)
	at org.globus.cog.karajan.workflow.nodes.FlowContainer.execute(FlowContainer.java:63)
	at org.globus.cog.karajan.workflow.nodes.FlowNode.restart(FlowNode.java:139)
	at org.globus.cog.karajan.workflow.nodes.FlowNode.start(FlowNode.java:197)
	at org.globus.cog.karajan.workflow.FlowElementWrapper.start(FlowElementWrapper.java:227)
	at org.globus.cog.karajan.workflow.events.EventBus.start(EventBus.java:104)
	at org.globus.cog.karajan.workflow.events.EventTargetPair.run(EventTargetPair.java:40)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
	at java.lang.Thread.run(Thread.java:662)

	at org.griphyn.vdl.karajan.lib.SetFieldValue.function(SetFieldValue.java:68)
	at org.griphyn.vdl.karajan.lib.VDLFunction.post(VDLFunction.java:67)
	at org.globus.cog.karajan.workflow.nodes.AbstractSequentialWithArguments.completed(AbstractSequentialWithArguments.java:194)
	at org.globus.cog.karajan.workflow.nodes.FlowNode.complete(FlowNode.java:214)
	at org.globus.cog.karajan.workflow.nodes.FlowContainer.post(FlowContainer.java:58)
	at org.globus.cog.karajan.workflow.nodes.functions.Argument.post(Argument.java:48)
	at org.globus.cog.karajan.workflow.nodes.AbstractSequentialWithArguments.completed(AbstractSequentialWithArguments.java:194)
	at org.globus.cog.karajan.workflow.nodes.FlowNode.complete(FlowNode.java:214)
	at org.globus.cog.karajan.workflow.nodes.FlowContainer.post(FlowContainer.java:58)
	at org.globus.cog.karajan.workflow.nodes.functions.AbstractFunction.post(AbstractFunction.java:28)
	at org.globus.cog.karajan.workflow.nodes.Sequential.startNext(Sequential.java:29)
	at org.globus.cog.karajan.workflow.nodes.Sequential.executeChildren(Sequential.java:20)
	at org.globus.cog.karajan.workflow.nodes.FlowContainer.execute(FlowContainer.java:63)
	at org.globus.cog.karajan.workflow.nodes.FlowNode.restart(FlowNode.java:139)
	at org.globus.cog.karajan.workflow.nodes.FlowNode.start(FlowNode.java:197)
	at org.globus.cog.karajan.workflow.FlowElementWrapper.start(FlowElementWrapper.java:227)
	at org.globus.cog.karajan.workflow.events.EventBus.start(EventBus.java:104)
	at org.globus.cog.karajan.workflow.events.EventTargetPair.run(EventTargetPair.java:40)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
	at java.lang.Thread.run(Thread.java:662)
Caused by: java.lang.RuntimeException: getArrayValue called on a struct: outputNames:string = one.count two.count three.count - Closed
	at org.griphyn.vdl.mapping.AbstractDataNode.getArrayValue(AbstractDataNode.java:330)
	at org.griphyn.vdl.mapping.file.ArrayFileMapper.existing(ArrayFileMapper.java:30)
	at org.griphyn.vdl.mapping.RootDataNode.checkInputs(RootDataNode.java:131)
	at org.griphyn.vdl.mapping.RootArrayDataNode.checkInputs(RootArrayDataNode.java:71)
	at org.griphyn.vdl.mapping.RootArrayDataNode.innerInit(RootArrayDataNode.java:59)
	at org.griphyn.vdl.mapping.RootArrayDataNode.handleClosed(RootArrayDataNode.java:83)
	at org.griphyn.vdl.mapping.AbstractDataNode.notifyListeners(AbstractDataNode.java:604)
	at org.griphyn.vdl.mapping.AbstractDataNode.closeShallow(AbstractDataNode.java:403)
	at org.griphyn.vdl.mapping.AbstractDataNode.setValue(AbstractDataNode.java:350)
	at org.griphyn.vdl.mapping.RootDataNode.setValue(RootDataNode.java:229)
	at org.griphyn.vdl.karajan.lib.SetFieldValue.deepCopy(SetFieldValue.java:116)
	at org.griphyn.vdl.karajan.lib.SetFieldValue.function(SetFieldValue.java:52)
	... 23 more
2011-07-15 00:15:09,207+0530 DEBUG countwords PROCEDURE line=4 thread=0-3 name=countwords
2011-07-15 00:15:09,207+0530 DEBUG countwords PROCEDURE line=4 thread=0-2 name=countwords
2011-07-15 00:15:09,207+0530 DEBUG countwords PROCEDURE line=4 thread=0-4 name=countwords
2011-07-15 00:15:09,235+0530 INFO  ExecutionContext Detailed exception: 
java.lang.RuntimeException: getArrayValue called on a struct: outputNames:string = one.count two.count three.count - Closed
Caused by: java.lang.RuntimeException: getArrayValue called on a struct: outputNames:string = one.count two.count three.count - Closed
	at org.griphyn.vdl.mapping.AbstractDataNode.getArrayValue(AbstractDataNode.java:330)
	at org.griphyn.vdl.mapping.file.ArrayFileMapper.existing(ArrayFileMapper.java:30)
	at org.griphyn.vdl.mapping.RootDataNode.checkInputs(RootDataNode.java:131)
	at org.griphyn.vdl.mapping.RootArrayDataNode.checkInputs(RootArrayDataNode.java:71)
	at org.griphyn.vdl.mapping.RootArrayDataNode.innerInit(RootArrayDataNode.java:59)
	at org.griphyn.vdl.mapping.RootArrayDataNode.handleClosed(RootArrayDataNode.java:83)
	at org.griphyn.vdl.mapping.AbstractDataNode.notifyListeners(AbstractDataNode.java:604)
	at org.griphyn.vdl.mapping.AbstractDataNode.closeShallow(AbstractDataNode.java:403)
	at org.griphyn.vdl.mapping.AbstractDataNode.setValue(AbstractDataNode.java:350)
	at org.griphyn.vdl.mapping.RootDataNode.setValue(RootDataNode.java:229)
	at org.griphyn.vdl.karajan.lib.SetFieldValue.deepCopy(SetFieldValue.java:116)
	at org.griphyn.vdl.karajan.lib.SetFieldValue.function(SetFieldValue.java:52)
	at org.griphyn.vdl.karajan.lib.VDLFunction.post(VDLFunction.java:67)
	at org.globus.cog.karajan.workflow.nodes.AbstractSequentialWithArguments.completed(AbstractSequentialWithArguments.java:194)
	at org.globus.cog.karajan.workflow.nodes.FlowNode.complete(FlowNode.java:214)
	at org.globus.cog.karajan.workflow.nodes.FlowContainer.post(FlowContainer.java:58)
	at org.globus.cog.karajan.workflow.nodes.functions.Argument.post(Argument.java:48)
	at org.globus.cog.karajan.workflow.nodes.AbstractSequentialWithArguments.completed(AbstractSequentialWithArguments.java:194)
	at org.globus.cog.karajan.workflow.nodes.FlowNode.complete(FlowNode.java:214)
	at org.globus.cog.karajan.workflow.nodes.FlowContainer.post(FlowContainer.java:58)
	at org.globus.cog.karajan.workflow.nodes.functions.AbstractFunction.post(AbstractFunction.java:28)
	at org.globus.cog.karajan.workflow.nodes.Sequential.startNext(Sequential.java:29)
	at org.globus.cog.karajan.workflow.nodes.Sequential.executeChildren(Sequential.java:20)
	at org.globus.cog.karajan.workflow.nodes.FlowContainer.execute(FlowContainer.java:63)
	at org.globus.cog.karajan.workflow.nodes.FlowNode.restart(FlowNode.java:139)
	at org.globus.cog.karajan.workflow.nodes.FlowNode.start(FlowNode.java:197)
	at org.globus.cog.karajan.workflow.FlowElementWrapper.start(FlowElementWrapper.java:227)
	at org.globus.cog.karajan.workflow.events.EventBus.start(EventBus.java:104)
	at org.globus.cog.karajan.workflow.events.EventTargetPair.run(EventTargetPair.java:40)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
	at java.lang.Thread.run(Thread.java:662)

	at org.griphyn.vdl.karajan.lib.SetFieldValue.function(SetFieldValue.java:68)
	at org.griphyn.vdl.karajan.lib.VDLFunction.post(VDLFunction.java:67)
	at org.globus.cog.karajan.workflow.nodes.AbstractSequentialWithArguments.completed(AbstractSequentialWithArguments.java:194)
	at org.globus.cog.karajan.workflow.nodes.FlowNode.complete(FlowNode.java:214)
	at org.globus.cog.karajan.workflow.nodes.FlowContainer.post(FlowContainer.java:58)
	at org.globus.cog.karajan.workflow.nodes.functions.Argument.post(Argument.java:48)
	at org.globus.cog.karajan.workflow.nodes.AbstractSequentialWithArguments.completed(AbstractSequentialWithArguments.java:194)
	at org.globus.cog.karajan.workflow.nodes.FlowNode.complete(FlowNode.java:214)
	at org.globus.cog.karajan.workflow.nodes.FlowContainer.post(FlowContainer.java:58)
	at org.globus.cog.karajan.workflow.nodes.functions.AbstractFunction.post(AbstractFunction.java:28)
	at org.globus.cog.karajan.workflow.nodes.Sequential.startNext(Sequential.java:29)
	at org.globus.cog.karajan.workflow.nodes.Sequential.executeChildren(Sequential.java:20)
	at org.globus.cog.karajan.workflow.nodes.FlowContainer.execute(FlowContainer.java:63)
	at org.globus.cog.karajan.workflow.nodes.FlowNode.restart(FlowNode.java:139)
	at org.globus.cog.karajan.workflow.nodes.FlowNode.start(FlowNode.java:197)
	at org.globus.cog.karajan.workflow.FlowElementWrapper.start(FlowElementWrapper.java:227)
	at org.globus.cog.karajan.workflow.events.EventBus.start(EventBus.java:104)
	at org.globus.cog.karajan.workflow.events.EventTargetPair.run(EventTargetPair.java:40)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
	at java.lang.Thread.run(Thread.java:662)
Caused by: java.lang.RuntimeException: getArrayValue called on a struct: outputNames:string = one.count two.count three.count - Closed
	at org.griphyn.vdl.mapping.AbstractDataNode.getArrayValue(AbstractDataNode.java:330)
	at org.griphyn.vdl.mapping.file.ArrayFileMapper.existing(ArrayFileMapper.java:30)
	at org.griphyn.vdl.mapping.RootDataNode.checkInputs(RootDataNode.java:131)
	at org.griphyn.vdl.mapping.RootArrayDataNode.checkInputs(RootArrayDataNode.java:71)
	at org.griphyn.vdl.mapping.RootArrayDataNode.innerInit(RootArrayDataNode.java:59)
	at org.griphyn.vdl.mapping.RootArrayDataNode.handleClosed(RootArrayDataNode.java:83)
	at org.griphyn.vdl.mapping.AbstractDataNode.notifyListeners(AbstractDataNode.java:604)
	at org.griphyn.vdl.mapping.AbstractDataNode.closeShallow(AbstractDataNode.java:403)
	at org.griphyn.vdl.mapping.AbstractDataNode.setValue(AbstractDataNode.java:350)
	at org.griphyn.vdl.mapping.RootDataNode.setValue(RootDataNode.java:229)
	at org.griphyn.vdl.karajan.lib.SetFieldValue.deepCopy(SetFieldValue.java:116)
	at org.griphyn.vdl.karajan.lib.SetFieldValue.function(SetFieldValue.java:52)
	... 23 more
2011-07-15 00:15:09,247+0530 INFO  Loader Swift finished with errors
